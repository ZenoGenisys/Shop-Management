<div class="add-data-container">
    <div class="page-header">
        <h1>Add Transaction</h1>
    </div>

        <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()">
            <div class="form-grid">
                <!-- Column 1 -->
                <div class="form-col">
                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Date</mat-label>
                        <input matInput [matDatepicker]="picker" formControlName="date">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Sale Type</mat-label>
                        <mat-select formControlName="sale">
                            <mat-option value="STANDARD">Standard</mat-option>
                            <mat-option value="SKIN_OUT">Skin Out</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Quantity</mat-label>
                        <input matInput type="number" formControlName="quantity" min="1" placeholder="1">
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Transaction Type</mat-label>
                        <mat-select formControlName="type">
                            <mat-option value="INCOME">Income</mat-option>
                            <mat-option value="EXPENSE">Expense</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width" *ngIf="transactionType === 'EXPENSE'">
                        <mat-label>Salary Amount</mat-label>
                        <span matPrefix>&#8377;&nbsp;</span>
                        <input matInput type="number" formControlName="salary_amount" placeholder="0">
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Total Amount</mat-label>
                        <input matInput type="number" formControlName="price" placeholder="0" [disabled]="true">
                        <span matPrefix>&#8377;&nbsp;</span>
                    </mat-form-field>
                </div>

                <!-- Column 2 -->
                <div class="form-col">
                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Gender</mat-label>
                        <mat-select formControlName="gender">
                            <mat-option value="MALE">Male</mat-option>
                            <mat-option value="FEMALE">Female</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Category</mat-label>
                        <mat-select formControlName="category">
                            <mat-option value="BROILER">Broiler</mat-option>
                            <mat-option value="COUNTRY_CHICKEN">Country Chicken</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Payment Method</mat-label>
                        <mat-select formControlName="payment_method">
                            <mat-option value="CASH">Cash</mat-option>
                            <mat-option value="ONLINE">Online</mat-option>
                            <mat-option value="PENDING">Pending</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width" *ngIf="transactionType === 'INCOME'">
                        <mat-label>Income Amount</mat-label>
                        <span matPrefix>&#8377;&nbsp;</span>
                        <input matInput type="number" formControlName="income_amount" placeholder="0">
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width" *ngIf="transactionType === 'EXPENSE'">
                        <mat-label>Purchase Amount</mat-label>
                        <span matPrefix>&#8377;&nbsp;</span>
                        <input matInput type="number" formControlName="purchase_amount" placeholder="0">
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width" *ngIf="transactionType === 'EXPENSE'">
                        <mat-label>Others Amount</mat-label>
                        <span matPrefix>&#8377;&nbsp;</span>
                        <input matInput type="number" formControlName="others_amount" placeholder="0">
                    </mat-form-field>
                </div>

                <!-- Column 3 -->
                <div class="form-col bulk-upload">
                    <h3>Bulk Upload</h3>
                    <div class="upload-box"
                        [class.drag-over]="dragOver"
                        (dragover)="onDragOver($event)"
                        (dragleave)="onDragLeave($event)"
                        (drop)="onDrop($event)">
                        <p>Drag & Drop Excel file here or</p>
                        <input #fileInput type="file" accept=".xlsx" style="display:none" (change)="onFileSelected($event)">
                        <button mat-stroked-button color="primary" type="button" (click)="fileInput.click()">Select File</button>
                        <div *ngIf="uploading" class="upload-status">Uploading...</div>
                        <div *ngIf="uploadSuccess" class="upload-status success">Upload successful!</div>
                        <div *ngIf="uploadError" class="upload-status error">{{uploadError}}</div>
                        <div *ngIf="dragOver" class="drag-hint">Drop file to upload</div>
                    </div>
                    <div class="sample-template">
                        <button mat-stroked-button color="secondary" (click)="downloadSampleTemplate()">
                            <mat-icon>download</mat-icon>
                            Download Sample Template
                        </button>
                        <small>You can upload multiple records at once using Excel (.xlsx)</small>
                    </div>
                </div>
            </div>

            <mat-form-field appearance="outline" class="full-width details-field">
                <mat-label>Details</mat-label>
                <textarea matInput formControlName="details" rows="3"></textarea>
            </mat-form-field>

            <div class="action-buttons">
                <button mat-button type="button" (click)="onReset()">Reset</button>
                <button mat-raised-button color="primary" type="submit" [disabled]="!transactionForm.valid">
                    Save Transaction
                </button>
            </div>
        </form>
</div>